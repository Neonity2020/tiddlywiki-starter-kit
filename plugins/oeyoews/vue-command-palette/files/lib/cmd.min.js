(function($,a){typeof exports=="object"&&typeof module<"u"?a(exports,require("$:/plugins/oeyoews/neotw-vue3/vue.global.prod.js")):typeof define=="function"&&define.amd?define(["exports","vue"],a):($=typeof globalThis<"u"?globalThis:$||self,a($.CmdBar={},$.Vue))})(this,function($,a){"use strict";function ie(t){return a.getCurrentScope()?(a.onScopeDispose(t),!0):!1}function M(t){return typeof t=="function"?t():a.unref(t)}const Ne=typeof window<"u"&&typeof document<"u",Fe=Object.prototype.toString,Ge=t=>Fe.call(t)==="[object Object]",V=()=>{};function ve(t,e){function n(...s){return new Promise((r,o)=>{Promise.resolve(t(()=>e.apply(this,s),{fn:e,thisArg:this,args:s})).then(r).catch(o)})}return n}function Te(t,e={}){let n,s,r=V;const o=c=>{clearTimeout(c),r(),r=V};return c=>{const l=M(t),u=M(e.maxWait);return n&&o(n),l<=0||u!==void 0&&u<=0?(s&&(o(s),s=null),Promise.resolve(c())):new Promise((d,h)=>{r=e.rejectOnCancel?h:d,u&&!s&&(s=setTimeout(()=>{n&&o(n),s=null,d(c())},u)),n=setTimeout(()=>{s&&o(s),s=null,d(c())},l)})}}function Pe(t,e=200,n={}){return ve(Te(e,n),t)}function Be(t,e,n){return a.watch(t,(s,r,o)=>{s&&e(s,r,o)},n)}function T(t){var e;const n=M(t);return(e=n==null?void 0:n.$el)!=null?e:n}const j=Ne?window:void 0;function D(...t){let e,n,s,r;if(typeof t[0]=="string"||Array.isArray(t[0])?([n,s,r]=t,e=j):[e,n,s,r]=t,!e)return V;Array.isArray(n)||(n=[n]),Array.isArray(s)||(s=[s]);const o=[],i=()=>{o.forEach(d=>d()),o.length=0},c=(d,h,f,p)=>(d.addEventListener(h,f,p),()=>d.removeEventListener(h,f,p)),l=a.watch(()=>[T(e),M(r)],([d,h])=>{if(i(),!d)return;const f=Ge(h)?{...h}:h;o.push(...n.flatMap(p=>s.map(g=>c(d,p,g,f))))},{immediate:!0,flush:"post"}),u=()=>{l(),i()};return ie(u),u}function ze(){const t=a.ref(!1);return a.getCurrentInstance()&&a.onMounted(()=>{t.value=!0}),t}function Ve(t){const e=ze();return a.computed(()=>(e.value,!!t()))}function je(t,e,n={}){const{window:s=j,...r}=n;let o;const i=Ve(()=>s&&"ResizeObserver"in s),c=()=>{o&&(o.disconnect(),o=void 0)},l=a.computed(()=>Array.isArray(t)?t.map(h=>T(h)):[T(t)]),u=a.watch(l,h=>{if(c(),i.value&&s){o=new ResizeObserver(e);for(const f of h)f&&o.observe(f,r)}},{immediate:!0,flush:"post",deep:!0}),d=()=>{c(),u()};return ie(d),{isSupported:i,stop:d}}function De(t,e={width:0,height:0},n={}){const{window:s=j,box:r="content-box"}=n,o=a.computed(()=>{var l,u;return(u=(l=T(t))==null?void 0:l.namespaceURI)==null?void 0:u.includes("svg")}),i=a.ref(e.width),c=a.ref(e.height);return je(t,([l])=>{const u=r==="border-box"?l.borderBoxSize:r==="content-box"?l.contentBoxSize:l.devicePixelContentBoxSize;if(s&&o.value){const d=T(t);if(d){const h=s.getComputedStyle(d);i.value=Number.parseFloat(h.width),c.value=Number.parseFloat(h.height)}}else if(u){const d=Array.isArray(u)?u:[u];i.value=d.reduce((h,{inlineSize:f})=>h+f,0),c.value=d.reduce((h,{blockSize:f})=>h+f,0)}else i.value=l.contentRect.width,c.value=l.contentRect.height},n),a.watch(()=>T(t),l=>{i.value=l?e.width:0,c.value=l?e.height:0}),{width:i,height:c}}const Ke={ctrl:"control",command:"meta",cmd:"meta",option:"alt",up:"arrowup",down:"arrowdown",left:"arrowleft",right:"arrowright"};function We(t={}){const{reactive:e=!1,target:n=j,aliasMap:s=Ke,passive:r=!0,onEventFired:o=V}=t,i=a.reactive(new Set),c={toJSON(){return{}},current:i},l=e?a.reactive(c):c,u=new Set,d=new Set;function h(_,k){_ in l&&(e?l[_]=k:l[_].value=k)}function f(){i.clear();for(const _ of d)h(_,!1)}function p(_,k){var b,E;const x=(b=_.key)==null?void 0:b.toLowerCase(),J=[(E=_.code)==null?void 0:E.toLowerCase(),x].filter(Boolean);x&&(k?i.add(x):i.delete(x));for(const S of J)d.add(S),h(S,k);x==="meta"&&!k?(u.forEach(S=>{i.delete(S),h(S,!1)}),u.clear()):typeof _.getModifierState=="function"&&_.getModifierState("Meta")&&k&&[...i,...J].forEach(S=>u.add(S))}D(n,"keydown",_=>(p(_,!0),o(_)),{passive:r}),D(n,"keyup",_=>(p(_,!1),o(_)),{passive:r}),D("blur",f,{passive:!0}),D("focus",f,{passive:!0});const g=new Proxy(l,{get(_,k,b){if(typeof k!="string")return Reflect.get(_,k,b);if(k=k.toLowerCase(),k in s&&(k=s[k]),!(k in l))if(/[+_-]/.test(k)){const x=k.split(/[+_-]/g).map(A=>A.trim());l[k]=a.computed(()=>x.every(A=>M(g[A])))}else l[k]=a.ref(!1);const E=Reflect.get(_,k,b);return e?M(E):E}});return g}function He(t,e){const{containerStyle:n,wrapperProps:s,scrollTo:r,calculateRange:o,currentList:i,containerRef:c}="itemHeight"in e?Ue(e,t):Qe(e,t);return{list:i,scrollTo:r,containerProps:{ref:c,onScroll:()=>{o()},style:n},wrapperProps:s}}function ce(t){const e=a.ref(null),n=De(e),s=a.ref([]),r=a.shallowRef(t);return{state:a.ref({start:0,end:10}),source:r,currentList:s,size:n,containerRef:e}}function ae(t,e,n){return s=>{if(typeof n=="number")return Math.ceil(s/n);const{start:r=0}=t.value;let o=0,i=0;for(let c=r;c<e.value.length;c++){const l=n(c);if(o+=l,i=c,o>s)break}return i-r}}function le(t,e){return n=>{if(typeof e=="number")return Math.floor(n/e)+1;let s=0,r=0;for(let o=0;o<t.value.length;o++){const i=e(o);if(s+=i,s>=n){r=o;break}}return r+1}}function de(t,e,n,s,{containerRef:r,state:o,currentList:i,source:c}){return()=>{const l=r.value;if(l){const u=n(t==="vertical"?l.scrollTop:l.scrollLeft),d=s(t==="vertical"?l.clientHeight:l.clientWidth),h=u-e,f=u+d+e;o.value={start:h<0?0:h,end:f>c.value.length?c.value.length:f},i.value=c.value.slice(o.value.start,o.value.end).map((p,g)=>({data:p,index:g+o.value.start}))}}}function ue(t,e){return n=>typeof t=="number"?n*t:e.value.slice(0,n).reduce((r,o,i)=>r+t(i),0)}function fe(t,e,n){a.watch([t.width,t.height,e],()=>{n()})}function he(t,e){return a.computed(()=>typeof t=="number"?e.value.length*t:e.value.reduce((n,s,r)=>n+t(r),0))}const Je={horizontal:"scrollLeft",vertical:"scrollTop"};function pe(t,e,n,s){return r=>{s.value&&(s.value[Je[t]]=n(r),e())}}function Qe(t,e){const n=ce(e),{state:s,source:r,currentList:o,size:i,containerRef:c}=n,l={overflowX:"auto"},{itemWidth:u,overscan:d=5}=t,h=ae(s,r,u),f=le(r,u),p=de("horizontal",d,f,h,n),g=ue(u,r),_=a.computed(()=>g(s.value.start)),k=he(u,r);fe(i,e,p);const b=pe("horizontal",p,g,c),E=a.computed(()=>({style:{height:"100%",width:`${k.value-_.value}px`,marginLeft:`${_.value}px`,display:"flex"}}));return{scrollTo:b,calculateRange:p,wrapperProps:E,containerStyle:l,currentList:o,containerRef:c}}function Ue(t,e){const n=ce(e),{state:s,source:r,currentList:o,size:i,containerRef:c}=n,l={overflowY:"auto"},{itemHeight:u,overscan:d=5}=t,h=ae(s,r,u),f=le(r,u),p=de("vertical",d,f,h,n),g=ue(u,r),_=a.computed(()=>g(s.value.start)),k=he(u,r);fe(i,e,p);const b=pe("vertical",p,g,c),E=a.computed(()=>({style:{width:"100%",height:`${k.value-_.value}px`,marginTop:`${_.value}px`}}));return{calculateRange:p,scrollTo:b,containerStyle:l,wrapperProps:E,currentList:o,containerRef:c}}function R(t){return Array.isArray?Array.isArray(t):ye(t)==="[object Array]"}const Ye=1/0;function Xe(t){if(typeof t=="string")return t;let e=t+"";return e=="0"&&1/t==-Ye?"-0":e}function Ze(t){return t==null?"":Xe(t)}function O(t){return typeof t=="string"}function me(t){return typeof t=="number"}function qe(t){return t===!0||t===!1||et(t)&&ye(t)=="[object Boolean]"}function ge(t){return typeof t=="object"}function et(t){return ge(t)&&t!==null}function C(t){return t!=null}function U(t){return!t.trim().length}function ye(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const an="Extended search is not available",tt="Incorrect 'index' type",nt=t=>`Invalid value for key ${t}`,st=t=>`Pattern length exceeds max of ${t}.`,rt=t=>`Missing ${t} property in key`,ot=t=>`Property 'weight' in key '${t}' must be a positive integer`,_e=Object.prototype.hasOwnProperty;class it{constructor(e){this._keys=[],this._keyMap={};let n=0;e.forEach(s=>{let r=we(s);n+=r.weight,this._keys.push(r),this._keyMap[r.id]=r,n+=r.weight}),this._keys.forEach(s=>{s.weight/=n})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function we(t){let e=null,n=null,s=null,r=1,o=null;if(O(t)||R(t))s=t,e=ke(t),n=Y(t);else{if(!_e.call(t,"name"))throw new Error(rt("name"));const i=t.name;if(s=i,_e.call(t,"weight")&&(r=t.weight,r<=0))throw new Error(ot(i));e=ke(i),n=Y(i),o=t.getFn}return{path:e,id:n,weight:r,src:s,getFn:o}}function ke(t){return R(t)?t:t.split(".")}function Y(t){return R(t)?t.join("."):t}function ct(t,e){let n=[],s=!1;const r=(o,i,c)=>{if(C(o))if(!i[c])n.push(o);else{let l=i[c];const u=o[l];if(!C(u))return;if(c===i.length-1&&(O(u)||me(u)||qe(u)))n.push(Ze(u));else if(R(u)){s=!0;for(let d=0,h=u.length;d<h;d+=1)r(u[d],i,c+1)}else i.length&&r(u,i,c+1)}};return r(t,O(e)?e.split("."):e,0),s?n:n[0]}var w={...{isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1},...{includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},...{location:0,threshold:.6,distance:100},...{useExtendedSearch:!1,getFn:ct,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1}};const at=/[^ ]+/g;function lt(t=1,e=3){const n=new Map,s=Math.pow(10,e);return{get(r){const o=r.match(at).length;if(n.has(o))return n.get(o);const i=1/Math.pow(o,.5*t),c=parseFloat(Math.round(i*s)/s);return n.set(o,c),c},clear(){n.clear()}}}class X{constructor({getFn:e=w.getFn,fieldNormWeight:n=w.fieldNormWeight}={}){this.norm=lt(n,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((n,s)=>{this._keysMap[n.id]=s})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,O(this.docs[0])?this.docs.forEach((e,n)=>{this._addString(e,n)}):this.docs.forEach((e,n)=>{this._addObject(e,n)}),this.norm.clear())}add(e){const n=this.size();O(e)?this._addString(e,n):this._addObject(e,n)}removeAt(e){this.records.splice(e,1);for(let n=e,s=this.size();n<s;n+=1)this.records[n].i-=1}getValueForItemAtKeyId(e,n){return e[this._keysMap[n]]}size(){return this.records.length}_addString(e,n){if(!C(e)||U(e))return;let s={v:e,i:n,n:this.norm.get(e)};this.records.push(s)}_addObject(e,n){let s={i:n,$:{}};this.keys.forEach((r,o)=>{let i=r.getFn?r.getFn(e):this.getFn(e,r.path);if(C(i)){if(R(i)){let c=[];const l=[{nestedArrIndex:-1,value:i}];for(;l.length;){const{nestedArrIndex:u,value:d}=l.pop();if(C(d))if(O(d)&&!U(d)){let h={v:d,i:u,n:this.norm.get(d)};c.push(h)}else R(d)&&d.forEach((h,f)=>{l.push({nestedArrIndex:f,value:h})})}s.$[o]=c}else if(O(i)&&!U(i)){let c={v:i,n:this.norm.get(i)};s.$[o]=c}}}),this.records.push(s)}toJSON(){return{keys:this.keys,records:this.records}}}function be(t,e,{getFn:n=w.getFn,fieldNormWeight:s=w.fieldNormWeight}={}){const r=new X({getFn:n,fieldNormWeight:s});return r.setKeys(t.map(we)),r.setSources(e),r.create(),r}function dt(t,{getFn:e=w.getFn,fieldNormWeight:n=w.fieldNormWeight}={}){const{keys:s,records:r}=t,o=new X({getFn:e,fieldNormWeight:n});return o.setKeys(s),o.setIndexRecords(r),o}function K(t,{errors:e=0,currentLocation:n=0,expectedLocation:s=0,distance:r=w.distance,ignoreLocation:o=w.ignoreLocation}={}){const i=e/t.length;if(o)return i;const c=Math.abs(s-n);return r?i+c/r:c?1:i}function ut(t=[],e=w.minMatchCharLength){let n=[],s=-1,r=-1,o=0;for(let i=t.length;o<i;o+=1){let c=t[o];c&&s===-1?s=o:!c&&s!==-1&&(r=o-1,r-s+1>=e&&n.push([s,r]),s=-1)}return t[o-1]&&o-s>=e&&n.push([s,o-1]),n}const v=32;function ft(t,e,n,{location:s=w.location,distance:r=w.distance,threshold:o=w.threshold,findAllMatches:i=w.findAllMatches,minMatchCharLength:c=w.minMatchCharLength,includeMatches:l=w.includeMatches,ignoreLocation:u=w.ignoreLocation}={}){if(e.length>v)throw new Error(st(v));const d=e.length,h=t.length,f=Math.max(0,Math.min(s,h));let p=o,g=f;const _=c>1||l,k=_?Array(h):[];let b;for(;(b=t.indexOf(e,g))>-1;){let I=K(e,{currentLocation:b,expectedLocation:f,distance:r,ignoreLocation:u});if(p=Math.min(I,p),g=b+d,_){let F=0;for(;F<d;)k[b+F]=1,F+=1}}g=-1;let E=[],x=1,A=d+h;const J=1<<d-1;for(let I=0;I<d;I+=1){let F=0,G=A;for(;F<G;)K(e,{errors:I,currentLocation:f+G,expectedLocation:f,distance:r,ignoreLocation:u})<=p?F=G:A=G,G=Math.floor((A-F)/2+F);A=G;let Re=Math.max(1,f-G+1),oe=i?h:Math.min(f+G,h)+d,B=Array(oe+2);B[oe+1]=(1<<I)-1;for(let L=oe;L>=Re;L-=1){let Q=L-1,Ae=n[t.charAt(Q)];if(_&&(k[Q]=+!!Ae),B[L]=(B[L+1]<<1|1)&Ae,I&&(B[L]|=(E[L+1]|E[L])<<1|1|E[L+1]),B[L]&J&&(x=K(e,{errors:I,currentLocation:Q,expectedLocation:f,distance:r,ignoreLocation:u}),x<=p)){if(p=x,g=Q,g<=f)break;Re=Math.max(1,2*f-g)}}if(K(e,{errors:I+1,currentLocation:f,expectedLocation:f,distance:r,ignoreLocation:u})>p)break;E=B}const S={isMatch:g>=0,score:Math.max(.001,x)};if(_){const I=ut(k,c);I.length?l&&(S.indices=I):S.isMatch=!1}return S}function ht(t){let e={};for(let n=0,s=t.length;n<s;n+=1){const r=t.charAt(n);e[r]=(e[r]||0)|1<<s-n-1}return e}class Ee{constructor(e,{location:n=w.location,threshold:s=w.threshold,distance:r=w.distance,includeMatches:o=w.includeMatches,findAllMatches:i=w.findAllMatches,minMatchCharLength:c=w.minMatchCharLength,isCaseSensitive:l=w.isCaseSensitive,ignoreLocation:u=w.ignoreLocation}={}){if(this.options={location:n,threshold:s,distance:r,includeMatches:o,findAllMatches:i,minMatchCharLength:c,isCaseSensitive:l,ignoreLocation:u},this.pattern=l?e:e.toLowerCase(),this.chunks=[],!this.pattern.length)return;const d=(f,p)=>{this.chunks.push({pattern:f,alphabet:ht(f),startIndex:p})},h=this.pattern.length;if(h>v){let f=0;const p=h%v,g=h-p;for(;f<g;)d(this.pattern.substr(f,v),f),f+=v;if(p){const _=h-v;d(this.pattern.substr(_),_)}}else d(this.pattern,0)}searchIn(e){const{isCaseSensitive:n,includeMatches:s}=this.options;if(n||(e=e.toLowerCase()),this.pattern===e){let g={isMatch:!0,score:0};return s&&(g.indices=[[0,e.length-1]]),g}const{location:r,distance:o,threshold:i,findAllMatches:c,minMatchCharLength:l,ignoreLocation:u}=this.options;let d=[],h=0,f=!1;this.chunks.forEach(({pattern:g,alphabet:_,startIndex:k})=>{const{isMatch:b,score:E,indices:x}=ft(e,g,_,{location:r+k,distance:o,threshold:i,findAllMatches:c,minMatchCharLength:l,includeMatches:s,ignoreLocation:u});b&&(f=!0),h+=E,b&&x&&(d=[...d,...x])});let p={isMatch:f,score:f?h/this.chunks.length:1};return f&&s&&(p.indices=d),p}}class N{constructor(e){this.pattern=e}static isMultiMatch(e){return xe(e,this.multiRegex)}static isSingleMatch(e){return xe(e,this.singleRegex)}search(){}}function xe(t,e){const n=t.match(e);return n?n[1]:null}class pt extends N{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const n=e===this.pattern;return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class mt extends N{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const s=e.indexOf(this.pattern)===-1;return{isMatch:s,score:s?0:1,indices:[0,e.length-1]}}}class gt extends N{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const n=e.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class yt extends N{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const n=!e.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class _t extends N{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const n=e.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class wt extends N{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const n=!e.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class Me extends N{constructor(e,{location:n=w.location,threshold:s=w.threshold,distance:r=w.distance,includeMatches:o=w.includeMatches,findAllMatches:i=w.findAllMatches,minMatchCharLength:c=w.minMatchCharLength,isCaseSensitive:l=w.isCaseSensitive,ignoreLocation:u=w.ignoreLocation}={}){super(e),this._bitapSearch=new Ee(e,{location:n,threshold:s,distance:r,includeMatches:o,findAllMatches:i,minMatchCharLength:c,isCaseSensitive:l,ignoreLocation:u})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class Ce extends N{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let n=0,s;const r=[],o=this.pattern.length;for(;(s=e.indexOf(this.pattern,n))>-1;)n=s+o,r.push([s,n-1]);const i=!!r.length;return{isMatch:i,score:i?0:1,indices:r}}}const Z=[pt,Ce,gt,yt,wt,_t,mt,Me],Ie=Z.length,kt=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,bt="|";function Et(t,e={}){return t.split(bt).map(n=>{let s=n.trim().split(kt).filter(o=>o&&!!o.trim()),r=[];for(let o=0,i=s.length;o<i;o+=1){const c=s[o];let l=!1,u=-1;for(;!l&&++u<Ie;){const d=Z[u];let h=d.isMultiMatch(c);h&&(r.push(new d(h,e)),l=!0)}if(!l)for(u=-1;++u<Ie;){const d=Z[u];let h=d.isSingleMatch(c);if(h){r.push(new d(h,e));break}}}return r})}const xt=new Set([Me.type,Ce.type]);class Mt{constructor(e,{isCaseSensitive:n=w.isCaseSensitive,includeMatches:s=w.includeMatches,minMatchCharLength:r=w.minMatchCharLength,ignoreLocation:o=w.ignoreLocation,findAllMatches:i=w.findAllMatches,location:c=w.location,threshold:l=w.threshold,distance:u=w.distance}={}){this.query=null,this.options={isCaseSensitive:n,includeMatches:s,minMatchCharLength:r,findAllMatches:i,ignoreLocation:o,location:c,threshold:l,distance:u},this.pattern=n?e:e.toLowerCase(),this.query=Et(this.pattern,this.options)}static condition(e,n){return n.useExtendedSearch}searchIn(e){const n=this.query;if(!n)return{isMatch:!1,score:1};const{includeMatches:s,isCaseSensitive:r}=this.options;e=r?e:e.toLowerCase();let o=0,i=[],c=0;for(let l=0,u=n.length;l<u;l+=1){const d=n[l];i.length=0,o=0;for(let h=0,f=d.length;h<f;h+=1){const p=d[h],{isMatch:g,indices:_,score:k}=p.search(e);if(g){if(o+=1,c+=k,s){const b=p.constructor.type;xt.has(b)?i=[...i,..._]:i.push(_)}}else{c=0,o=0,i.length=0;break}}if(o){let h={isMatch:!0,score:c/o};return s&&(h.indices=i),h}}return{isMatch:!1,score:1}}}const q=[];function Ct(...t){q.push(...t)}function ee(t,e){for(let n=0,s=q.length;n<s;n+=1){let r=q[n];if(r.condition(t,e))return new r(t,e)}return new Ee(t,e)}const W={AND:"$and",OR:"$or"},te={PATH:"$path",PATTERN:"$val"},ne=t=>!!(t[W.AND]||t[W.OR]),It=t=>!!t[te.PATH],St=t=>!R(t)&&ge(t)&&!ne(t),Se=t=>({[W.AND]:Object.keys(t).map(e=>({[e]:t[e]}))});function Le(t,e,{auto:n=!0}={}){const s=r=>{let o=Object.keys(r);const i=It(r);if(!i&&o.length>1&&!ne(r))return s(Se(r));if(St(r)){const l=i?r[te.PATH]:o[0],u=i?r[te.PATTERN]:r[l];if(!O(u))throw new Error(nt(l));const d={keyId:Y(l),pattern:u};return n&&(d.searcher=ee(u,e)),d}let c={children:[],operator:o[0]};return o.forEach(l=>{const u=r[l];R(u)&&u.forEach(d=>{c.children.push(s(d))})}),c};return ne(t)||(t=Se(t)),s(t)}function Lt(t,{ignoreFieldNorm:e=w.ignoreFieldNorm}){t.forEach(n=>{let s=1;n.matches.forEach(({key:r,norm:o,score:i})=>{const c=r?r.weight:null;s*=Math.pow(i===0&&c?Number.EPSILON:i,(c||1)*(e?1:o))}),n.score=s})}function $t(t,e){const n=t.matches;e.matches=[],C(n)&&n.forEach(s=>{if(!C(s.indices)||!s.indices.length)return;const{indices:r,value:o}=s;let i={indices:r,value:o};s.key&&(i.key=s.key.src),s.idx>-1&&(i.refIndex=s.idx),e.matches.push(i)})}function Ot(t,e){e.score=t.score}function Rt(t,e,{includeMatches:n=w.includeMatches,includeScore:s=w.includeScore}={}){const r=[];return n&&r.push($t),s&&r.push(Ot),t.map(o=>{const{idx:i}=o,c={item:e[i],refIndex:i};return r.length&&r.forEach(l=>{l(o,c)}),c})}class P{constructor(e,n={},s){this.options={...w,...n},this.options.useExtendedSearch,this._keyStore=new it(this.options.keys),this.setCollection(e,s)}setCollection(e,n){if(this._docs=e,n&&!(n instanceof X))throw new Error(tt);this._myIndex=n||be(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){C(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const n=[];for(let s=0,r=this._docs.length;s<r;s+=1){const o=this._docs[s];e(o,s)&&(this.removeAt(s),s-=1,r-=1,n.push(o))}return n}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:n=-1}={}){const{includeMatches:s,includeScore:r,shouldSort:o,sortFn:i,ignoreFieldNorm:c}=this.options;let l=O(e)?O(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return Lt(l,{ignoreFieldNorm:c}),o&&l.sort(i),me(n)&&n>-1&&(l=l.slice(0,n)),Rt(l,this._docs,{includeMatches:s,includeScore:r})}_searchStringList(e){const n=ee(e,this.options),{records:s}=this._myIndex,r=[];return s.forEach(({v:o,i,n:c})=>{if(!C(o))return;const{isMatch:l,score:u,indices:d}=n.searchIn(o);l&&r.push({item:o,idx:i,matches:[{score:u,value:o,norm:c,indices:d}]})}),r}_searchLogical(e){const n=Le(e,this.options),s=(c,l,u)=>{if(!c.children){const{keyId:h,searcher:f}=c,p=this._findMatches({key:this._keyStore.get(h),value:this._myIndex.getValueForItemAtKeyId(l,h),searcher:f});return p&&p.length?[{idx:u,item:l,matches:p}]:[]}const d=[];for(let h=0,f=c.children.length;h<f;h+=1){const p=c.children[h],g=s(p,l,u);if(g.length)d.push(...g);else if(c.operator===W.AND)return[]}return d},r=this._myIndex.records,o={},i=[];return r.forEach(({$:c,i:l})=>{if(C(c)){let u=s(n,c,l);u.length&&(o[l]||(o[l]={idx:l,item:c,matches:[]},i.push(o[l])),u.forEach(({matches:d})=>{o[l].matches.push(...d)}))}}),i}_searchObjectList(e){const n=ee(e,this.options),{keys:s,records:r}=this._myIndex,o=[];return r.forEach(({$:i,i:c})=>{if(!C(i))return;let l=[];s.forEach((u,d)=>{l.push(...this._findMatches({key:u,value:i[d],searcher:n}))}),l.length&&o.push({idx:c,item:i,matches:l})}),o}_findMatches({key:e,value:n,searcher:s}){if(!C(n))return[];let r=[];if(R(n))n.forEach(({v:o,i,n:c})=>{if(!C(o))return;const{isMatch:l,score:u,indices:d}=s.searchIn(o);l&&r.push({score:u,key:e,value:o,idx:i,norm:c,indices:d})});else{const{v:o,n:i}=n,{isMatch:c,score:l,indices:u}=s.searchIn(o);c&&r.push({score:l,key:e,value:o,norm:i,indices:u})}return r}}P.version="6.6.2",P.createIndex=be,P.parseIndex=dt,P.config=w,P.parseQuery=Le,Ct(Mt);function At(t,e,n){const s=()=>{var i,c;return new P((i=M(e))!=null?i:[],(c=M(n))==null?void 0:c.fuseOptions)},r=a.ref(s());a.watch(()=>{var i;return(i=M(n))==null?void 0:i.fuseOptions},()=>{r.value=s()},{deep:!0}),a.watch(()=>M(e),i=>{r.value.setCollection(i)},{deep:!0});const o=a.computed(()=>{const i=M(n);if(i!=null&&i.matchAllWhenSearchEmpty&&!M(t))return M(e).map((l,u)=>({item:l,refIndex:u}));const c=i==null?void 0:i.resultLimit;return r.value.search(M(t),c?{limit:c}:void 0)});return{fuse:r,results:o}}function Nt(t){return{all:t=t||new Map,on:function(e,n){var s=t.get(e);s?s.push(n):t.set(e,[n])},off:function(e,n){var s=t.get(e);s&&(n?s.splice(s.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var s=t.get(e);s&&s.slice().map(function(r){r(n)}),(s=t.get("*"))&&s.slice().map(function(r){r(e,n)})}}}const Ft=Nt(),z=()=>({emitter:Ft});function Gt(t,e){return t.find(n=>n.id===e)}const y=a.reactive({selectedCommandId:null,selectedGroups:new Set,parentCommandId:null,query:"",commands:[],groupedCommands:[],filteredGroupedCommands:[],filteredCommands:[],groupLoadingStates:{}}),m={state:a.readonly(y),initState(t){var s;const e=[],n=[];for(const r of t){const o=(s=r.commands)==null?void 0:s.map(i=>({...i,group:r.key}));e.push(...o??[]),n.push({...r,commands:o??[]})}y.groupedCommands=n,y.commands=e,y.filteredGroupedCommands=JSON.parse(JSON.stringify(n)),y.filteredCommands=e,H()},filterGroupedCommands(){y.selectedGroups.size===0?y.filteredGroupedCommands=JSON.parse(JSON.stringify(y.groupedCommands)):y.filteredGroupedCommands=JSON.parse(JSON.stringify(y.groupedCommands.filter(t=>y.selectedGroups.has(t.key)))),H()},resetState(){y.selectedCommandId=null,y.query="",this.filterGroupedCommands()},selectCommand(t){y.selectedCommandId=t},toggleGroup(t,e){y.selectedGroups.has(t)?y.selectedGroups.delete(t):(e||y.selectedGroups.clear(),y.selectedGroups.add(t)),this.filterGroupedCommands()},resetFilter(){y.selectedGroups.clear(),this.filterGroupedCommands()},nextCommand(){const t=$e();t>0&&(y.selectedCommandId=y.filteredCommands[t-1].id)},prevCommand(){const t=$e();t<y.filteredCommands.length-1&&(y.selectedCommandId=y.filteredCommands[t+1].id)},executeCommand(){var n;const{emitter:t}=z(),e=Gt(y.commands,y.selectedCommandId);e&&(t.emit("clicked",e),(n=e.action)==null||n.call(e))},async updateQuery(t,e){if(y.query=t,t===""){this.filterGroupedCommands();return}if(y.selectedGroups.size===0)await se(t,y.groupedCommands,e);else if(y.selectedGroups.size===1){const n=y.groupedCommands.find(s=>y.selectedGroups.has(s.key));n?await se(t,[n],e):console.warn(`Group ${y.selectedGroups.values().next()} not found`)}else{const n=y.groupedCommands.filter(s=>y.selectedGroups.has(s.key));await se(t,n,e)}},clearQuery(){y.query="",this.filterGroupedCommands()}},se=async(t,e,n)=>{const s=e.filter(o=>!o.search),r=e.filter(o=>!!o.search);s.length>0&&vt(t,s,n),r.length>0&&await Tt(t,r)},vt=(t,e,n)=>{e.forEach((s,r)=>{const{results:o}=At(t,a.ref(s.commands||[]),n);y.filteredGroupedCommands[r].commands=o.value.map(i=>i.item)})},Tt=Pe(async(t,e)=>{e.length&&await Promise.all(e.map(async n=>{y.groupLoadingStates[n.key]=!0;const s=await n.search(t),r=y.filteredGroupedCommands.findIndex(o=>o.key===n.key);s.forEach(o=>{o.group=n.key}),y.filteredGroupedCommands[r].commands=s,y.groupLoadingStates[n.key]=!1})).then(()=>{H()})},200);function $e(){return y.filteredCommands.findIndex(t=>t.id===y.selectedCommandId)}function H(){var n,s;const{emitter:t}=z(),e=((s=(n=y.filteredGroupedCommands[0])==null?void 0:n.commands)==null?void 0:s[0])??null;e?(y.selectedCommandId=e.id,t.emit("selected",e)):y.filteredGroupedCommands.length>0&&console.warn("No command found, by trying to select the first command")}a.watch(()=>y.filteredGroupedCommands,()=>{y.filteredCommands=y.filteredGroupedCommands.flatMap(t=>(t.commands??[]).map(e=>({...e,group:t.key}))),H()},{deep:!0});function Pt(){const t=a.ref([]),e=We(),n=o=>{const{key:i,action:c,override:l=!1,autoRepeat:u=!1}=o;if(i.includes("+")){const d=e[i];(l||!t.value.some(h=>h.key===i))&&Be(d,c)}else(l||!t.value.some(d=>d.key===i))&&t.value.push({key:i,action:c,autoRepeat:u,override:l})},s=o=>{const i=t.value.findIndex(c=>c.key===o);i!==-1&&t.value.splice(i,1)},r=o=>{const i=t.value.find(c=>c.key===o.key);if(i&&i.action){if(!i.autoRepeat&&o.repeat)return;i.action()}};return a.onMounted(()=>{window.addEventListener("keydown",r)}),a.onBeforeUnmount(()=>{window.removeEventListener("keydown",r)}),{registerKeyBinding:n,removeKeyBinding:s,keymap:t}}function re(t){const e={next:()=>m.nextCommand(),prev:()=>m.prevCommand(),execute:()=>m.executeCommand()},{registerKeyBinding:n}=Pt();return t(e).forEach(o=>{o.key&&n(o)}),{addKeyBindingsFromCommands:o=>{o.forEach(i=>{var c;(c=i.commands)==null||c.forEach(l=>{if(l.shortcut){const u=l.action,d={key:l.shortcut,action:u};n(d)}})})}}}const Oe=a.defineComponent({__name:"CmdBar",props:{commands:{type:Array,required:!0}},setup(t){const e=t;return re(n=>[{key:"ArrowUp",action:()=>n.next(),autoRepeat:!0},{key:"ArrowDown",action:()=>n.prev(),autoRepeat:!0},{key:"Enter",action:()=>n.execute(),autoRepeat:!0}]).addKeyBindingsFromCommands(e.commands),a.watch(()=>e.commands,()=>{m==null||m.initState(e.commands)},{deep:!0,immediate:!0}),(n,s)=>(a.openBlock(),a.createElementBlock("div",null,[a.renderSlot(n.$slots,"default")]))}}),Bt={class:"input-container"},zt={class:"input__leading","aria-hidden":"true"},Vt=["value","placeholder","aria-label"],jt={class:"input__clear"},Dt=a.defineComponent({__name:"CmdBarInput",props:{placeholder:{type:String,default:"Search"},fuse:{type:Object,default:()=>({})}},emits:["input"],setup(t,{emit:e}){const n=t,s=a.computed(()=>m==null?void 0:m.state.query),r=a.computed(()=>{var c,l,u;return{fuseOptions:{...(c=n.fuse)==null?void 0:c.fuseOptions,keys:((u=(l=n.fuse)==null?void 0:l.fuseOptions)==null?void 0:u.keys)??["label"],minMatchCharLength:2},resultLimit:12}});function o(c){var l;m==null||m.updateQuery((l=c.target)==null?void 0:l.value,r.value)}function i(){m==null||m.clearQuery()}return(c,l)=>(a.openBlock(),a.createElementBlock("div",Bt,[a.createElementVNode("span",zt,[a.renderSlot(c.$slots,"leading")]),a.createElementVNode("input",{"data-cmd-bar-input":"",class:"input",autofocus:"",autocomplete:"off","aria-autocomplete":"list",role:"combobox",value:s.value,placeholder:t.placeholder,"aria-label":t.placeholder,onInput:o},null,40,Vt),a.createElementVNode("div",jt,[a.createElementVNode("button",{"aria-label":"Close",tabindex:"-1",onClick:i},[a.renderSlot(c.$slots,"clear")])])]))}}),Kt={class:"group-container"},Wt={key:0,"data-cmd-bar-items":"",class:"items"},Ht=["data-id","aria-selected","onMousemove","onClick"],Jt={key:1,class:"loading"},Qt=a.defineComponent({__name:"CmdBarGroup",props:{group:{}},emits:["selected","clicked"],setup(t,{emit:e}){const n=t,{emitter:s}=z(),r=a.computed(()=>c=>(m==null?void 0:m.state.selectedCommandId)===c.id?(s.emit("selected",c),!0):!1),o=a.computed(()=>m==null?void 0:m.state.groupLoadingStates[n.group.key]);function i(c){s.emit("clicked",c),m==null||m.executeCommand()}return(c,l)=>(a.openBlock(),a.createElementBlock("div",Kt,[!o.value&&c.group.commands?(a.openBlock(),a.createElementBlock("ul",Wt,[(a.openBlock(!0),a.createElementBlock(a.Fragment,null,a.renderList(c.group.commands,(u,d)=>(a.openBlock(),a.createElementBlock("li",{key:`${c.group.key}-${d}`,"data-id":u.id,role:"option",class:"item","aria-selected":r.value(u),onMousemove:h=>{var f;return(f=a.unref(m))==null?void 0:f.selectCommand(u.id)},onClick:h=>i(u)},[a.renderSlot(c.$slots,"default",{command:u})],40,Ht))),128))])):(a.openBlock(),a.createElementBlock("div",Jt,[a.renderSlot(c.$slots,"loading",{group:c.group})]))]))}}),Ut=a.defineComponent({__name:"CmdBarList",props:{config:{}},setup(t){const e=t,n=a.ref(null),s=a.ref(null),r=a.computed(()=>m==null?void 0:m.state.filteredGroupedCommands.flatMap(f=>{const p={key:f.key,label:f.label};return f.commands?[p,...f.commands]:[p]})),{containerProps:o,wrapperProps:i,list:c}=He(r,{itemHeight:f=>{const p=r.value[f];if(typeof p=="string")return e.config.groupLabelHeightInPixel??0;if(typeof e.config.itemHeightInPixel=="number")return e.config.itemHeightInPixel;const g=p==null?void 0:p.group;return g?(e.config.itemHeightInPixel[g]||console.error(`No height defined for group "${g}". Please define a height for this group in the config for the list component.`),e.config.itemHeightInPixel[g]):0}}),l=a.computed(()=>c.value.reduce((f,p)=>{var k;const g=p.data.key||p.data.group,_=f.find(b=>b.key===g);if(_)p.data.id&&((k=_.commands)==null||k.push(p.data));else{const b={key:g,label:p.data.label,commands:[]};f.push(b)}return f},[]));a.watchEffect(()=>{o.style={height:e.config.containerHeight}}),a.watchEffect(()=>{var f;(f=n.value)==null||f.forEach(p=>{p.style.height=`${e.config.groupLabelHeightInPixel}px`})});const u=()=>{var p;const f=m==null?void 0:m.state.selectedCommandId;return(p=o.ref.value)==null?void 0:p.querySelector(`[data-id="${f}"]`)},d=()=>{var p,g,_;const f=u();if(((p=f==null?void 0:f.parentElement)==null?void 0:p.firstElementChild)===f){(_=(g=f==null?void 0:f.closest(".group"))==null?void 0:g.querySelector(".group__label"))==null||_.scrollIntoView({block:"nearest"});return}f==null||f.scrollIntoView({block:"nearest"})},{emitter:h}=z();return h.on("selected",f=>{console.log("selected",f),s.value=f}),a.watch(()=>m==null?void 0:m.state.selectedCommandId,f=>{f&&a.nextTick(d)}),(f,p)=>(a.openBlock(),a.createElementBlock(a.Fragment,null,[a.createElementVNode("div",a.mergeProps({class:"grouped-list"},a.unref(o)),[a.createElementVNode("ul",a.mergeProps({"data-cmd-bar-items":"",class:"list-items"},a.unref(i)),[(a.openBlock(!0),a.createElementBlock(a.Fragment,null,a.renderList(l.value,g=>{var _;return a.openBlock(),a.createElementBlock("li",{key:g.key,class:"group"},[g.label&&g.commands&&((_=g.commands)==null?void 0:_.length)>0?(a.openBlock(),a.createElementBlock("h2",{key:0,ref_for:!0,ref_key:"labelRef",ref:n,class:"group__label"},a.toDisplayString(g.label),513)):a.createCommentVNode("",!0),a.createVNode(Qt,{group:g},a.createSlots({_:2},[a.renderList(f.$slots,(k,b)=>({name:b,fn:a.withCtx(E=>[a.renderSlot(f.$slots,b,a.normalizeProps(a.guardReactiveProps(E)))])}))]),1032,["group"])])}),128))],16)],16),a.renderSlot(f.$slots,"preview",{command:s.value})],64))}}),Yt={class:"filter"},Xt={class:"filter-list",role:"tablist"},Zt=["data-id","aria-selected","onClick"],qt=a.defineComponent({__name:"CmdBarFilter",props:{defaultFilterOption:{type:String,default:null},asCheckbox:{type:Boolean,default:!1}},emits:["filterChange"],setup(t,{emit:e}){const n=t,s=m==null?void 0:m.state.selectedGroups,r=m==null?void 0:m.state.groupedCommands.map(d=>d.key),o=new Set(n.defaultFilterOption?[n.defaultFilterOption,...r]:r),i=a.ref({transform:"translateX(0)",width:"0"});re(()=>[{key:"Space",action:()=>{const d=document.activeElement;if(d&&d.classList.contains("filter-chip")){const h=d.dataset.id;h!==void 0&&l(h)}},autoRepeat:!1}]);function c(d){return d===n.defaultFilterOption&&s.size===0?!0:s.has(d)}function l(d){d!==n.defaultFilterOption?(m==null||m.toggleGroup(d,n.asCheckbox),e("filterChange",Array.from(s)),s.size===0&&(m==null||m.resetFilter()),u()):(m==null||m.toggleGroup(d,n.asCheckbox),u(),m==null||m.resetFilter())}a.onMounted(()=>{l(n==null?void 0:n.defaultFilterOption)}),a.watchEffect(()=>{if(!(typeof window<"u"))return null;const h=new ResizeObserver(()=>{u()});a.nextTick(()=>{const f=document.querySelector(".filter");f&&h.observe(f)})});async function u(){await a.nextTick(()=>{const d=document.querySelector('.filter-chip[aria-selected="true"]');if(!d)return;const h=d.clientWidth,f=d.offsetLeft;i.value={transform:`translateX(${f}px)`,width:h+"px"}})}return(d,h)=>(a.openBlock(),a.createElementBlock("div",Yt,[a.createElementVNode("div",Xt,[(a.openBlock(!0),a.createElementBlock(a.Fragment,null,a.renderList(a.unref(o),f=>(a.openBlock(),a.createElementBlock("button",{key:f,"data-id":f,class:"filter-chip","aria-selected":c(f),role:"tab",tabindex:"0",onClick:p=>l(f)},a.toDisplayString(f),9,Zt))),128))]),a.createElementVNode("div",{style:a.normalizeStyle(i.value),class:"filter-line"},null,4)]))}}),en={"data-cmd-bar-wrapper":"",class:"cmd-bar__wrapper"},tn={"data-cmd-bar-header":"",class:"cmd-bar__header"},nn={"data-cmd-bar-content":"",class:"cmd-bar__body"},sn={"data-cmd-bar-footer":"",class:"cmd-bar__footer"},rn=a.defineComponent({__name:"CmdBarDialog",props:{visible:{type:Boolean,default:!1}},setup(t){const e=t,n=a.ref(null);function s(){var i,c,l;n.value&&((i=n.value)!=null&&i.open?((c=n.value)==null||c.close(),m==null||m.resetState()):(l=n.value)==null||l.showModal())}a.watch(()=>e.visible,()=>s());function r(){var i;(i=n.value)==null||i.close()}const o={mounted(i,c){i.__ClickOutsideHandler__=l=>{i===l.target||i.contains(l.target)||c.value(l,i)},document.body.addEventListener("click",i.__ClickOutsideHandler__)},unmounted(i){document.body.removeEventListener("click",i.__ClickOutsideHandler__)}};return(i,c)=>(a.openBlock(),a.createElementBlock("dialog",{ref_key:"dialogRef",ref:n,"data-cmd-bar":"",class:"cmd-bar"},[a.withDirectives((a.openBlock(),a.createElementBlock("div",en,[a.createElementVNode("div",tn,[a.renderSlot(i.$slots,"header")]),a.createElementVNode("div",nn,[a.renderSlot(i.$slots,"content")]),a.createElementVNode("div",sn,[a.renderSlot(i.$slots,"footer")])])),[[o,r]])],512))}});function on(t){return t}const cn=Object.assign(Oe,{Input:Dt,List:Ut,Filter:qt,Dialog:rn,Root:Oe});$.CmdBar=cn,$.defineCommand=on,$.useCmdBarEvent=z,$.useKeymap=re,Object.defineProperty($,Symbol.toStringTag,{value:"Module"})});
